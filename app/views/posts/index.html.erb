<div class="bg-color">
  <h1 class="bg-info text-center main-header">気になる離島を見つけてみよう！</h1>
  <div class="container">
    <div class="flexbox-center">
      <div class="form-group search-form">
        <p class="label label-default">キーワードと離島名で検索</p>
        <%= search_form_for @q, url: posts_path do |f| %>
          <div class="field">
            <%= f.label :content_cont, 'キーワード' %>
            <%= f.search_field :content_cont, class: 'form-control', placeholder: '気になるワードで検索できます' %><br>
            <%= f.label :islands_id_eq, '離島名' %>
            <%= f.collection_select :islands_id_eq, Island.all, :id, :name, {include_blank: '--未選択--'}, {class: 'form-control test-island'} %><br>
          </div>
          <div class="text-center search-btn">
            <%= f.submit '検索', class: 'test' %>
          </div>
        <% end %>
      </div>
      <div class="form-group search-form">
        <p class="label label-default">都道府県名で検索</p>
        <%= search_form_for @q, url: posts_path do |f| %>
          <div class="prefecture-field">
            <% Post.prefectures.each do |prefecture| %>
              <% if prefecture[0] == "北海道" %>
                <p>北海道・東北</p>
              <% elsif prefecture[0] == "茨城県" %>
                <p class="area-title">関東</p>
              <% elsif prefecture[0] == "新潟県" %>
                <p class="area-title">中部</p>
              <% elsif prefecture[0] == "三重県" %>
                <p class="area-title">関西</p>
              <% elsif prefecture[0] == "鳥取県" %>
                <p class="area-title">中国</p>
              <% elsif prefecture[0] == "徳島県" %>
                <p class="area-title">四国</p>
              <% elsif prefecture[0] == "福岡県" %>
                <p class="area-title">九州・沖縄</p>
              <% end %>
              <%= f.label :prefecture_eq, prefecture[0] %>
              <%= f.radio_button :prefecture_eq, prefecture[1] %>
            <% end %>
            <div class="text-center search-btn search-btn-prefecture">
              <%= f.submit '検索', class: 'test2' %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
    <div class="flexbox-center">
      <div class="contents">
        <% @posts.each do |post| %>
          <div class="main-content">
            <ul class="list-inline items">
              <li><%= image_tag post.user.icon.variant(gravity: 'Center', resize: '60x60'), class:'img-circle' if post.user.icon.attached? %></li>
              <li><%= post.user.name %></li>
              <% unless post.prefecture == '--未選択--' %>
                <li><%= post.prefecture %></li>
              <% end %>
              <% if post.islands.present? %>
                <% post.islands.each do |island|%>
                  <li><%= link_to island.name, posts_path(island.id, search_island: "true"), class: 'label label-primary' %></li>
                <% end %>
              <% end %>
              <li class="list-time"><%= "#{time_ago_in_words(post.created_at)}前" %></li>
            </ul>
            <ul class="media-list">
              <li class="media">
                <div class="media-top">
                  <%= link_to post.image, "data-lightbox": post.image do %>
                    <%= image_tag post.image.variant(gravity: 'Center', resize: '500x600'), class:'main-image polaroid' if post.image.attached? %>
                  <% end %>
                </div>
                <div class="media-body content-space">
                  <%= post.content %>
                </div>
              </li>
            </ul>
          </div>
          <div class="sub-content">
            <ul class="list-inline content-space flexbox-space-around">
              <li id="favorite-btn-<%= post.id %>">
                <%= render partial: 'favorites/favorite', locals: { post: post } %>
              </li>
              <li><%= "コメント#{post.comments.count}件" %></li>
              <% unless post.user == current_user %>
                <li><%= link_to t('view.comment'), post %></li>
              <% end %>
              <li><%= link_to t('view.show'), post %></li>
            </ul>
          </div>
          <div class="comment-content">
            <% post.comments.limit(3).each do |comment| %>
              <ul class="media-list">
                <li class="media content-space">
                  <div class="media-left">
                    <%= image_tag comment.user.icon.variant(gravity: 'Center', resize: '40x40'), class:'img-circle' if comment.user.icon.attached? %>
                  </div>
                  <div class="media-body">
                    <% if comment.user == current_user %>
                      <p class="comment-space oneself">
                    <% else %>
                      <p class="comment-space">
                    <% end %>
                    <%= comment.content %></p>
                  </div>
                </li>
              </ul>
            <% end %>
            <% if post.comments.count >= 4 %>
              <p class="text-right comment-link-space"><%= link_to t('view.all_comments'), post %></p>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
